import{defineStore as g}from"./pinia-Cxh1ZB3t.js";import{r as u,B as o,D as I,h as C}from"./index-ij1VbRDO.js";function p(t){const r=/^[a-zA-Z0-9]+([-.]{1}[a-zA-Z0-9]+)*\.[a-zA-Z]{2,}$/;return!!t.match(r)}function l(t){if(!(typeof t!="string"||t.length===0))return!(t.length>1&&p(t))}function A(t,r="cert"){let a;switch(r){case"csr":a=/^-----BEGIN CERTIFICATE REQUEST-----\n[\s\S]+?\n-----END CERTIFICATE REQUEST-----$/;break;case"key":a=/^-----BEGIN RSA PRIVATE KEY-----\n[\s\S]+?\n-----END RSA PRIVATE KEY-----$/;break;case"cert":default:a=/^-----BEGIN CERTIFICATE-----\n[\s\S]+?\n-----END CERTIFICATE-----$/;break}return a.test(t)}function i(t,r=null){if(!(typeof t!="string"||t.length===0))return!(t.length>1&&A(t,r))}var y=[{id:"cert_domain",content:null,type:"cert",name:"domain",format:"crt",required:!0},{id:"cert_inter",content:null,type:"cert",name:"intermediate",format:"crt",required:!1},{id:"cert_root",content:null,type:"cert",name:"root",format:"crt",required:!0},{id:"private_key",content:null,type:"key",name:"private",format:"key",required:!0},{id:"csr_code",content:null,type:"csr",name:"request",format:"csr",required:!1}];const N=g("global",()=>{const t=u(""),r=u(y),a=u(o.language||I);function s(e){a.value=e,o.changeLanguage(e)}o.on("languageChanged",e=>{a.value=e});const c=C(()=>l(t.value));function f(e,n){return i(e,n)}function d(e){return r.value.find(n=>n.id===e)}function m(){return r.value.every(e=>e.required?e.content!==null&&e.content.trim()!=="":!0)}function E(){return l(t.value)||t.value.trim()===""?!1:r.value.every(e=>e.required?e.content&&e.content.trim()!==""&&!i(e.content,e.type):e.content&&e.content.trim()!==""?!i(e.content,e.type):!0)}function v(){const e=r.value.filter(n=>!!(n.required&&(!n.content||n.content.trim()==="")||n.content&&n.content.trim()!==""&&i(n.content,n.type))).map(n=>`certs.${n.id}.title`);return(l(t.value)||t.value.trim()==="")&&e.unshift("ui.domain_name"),e}return{domainName:t,currentLanguage:a,setLanguage:s,checkAriaInvalidDomainName:c,checkAriaInvalidCertContent:f,certs:r,getCertById:d,areRequiredCertsFilled:m,areCertsValid:E,getInvalidCerts:v}});export{N as u};
