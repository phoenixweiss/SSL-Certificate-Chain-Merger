import{defineStore as C}from"./pinia-CmCh0esP.js";import{r as u,B as l,D as A,h as T}from"./index-9F2qjDQD.js";function R(t){const r=/^[a-zA-Z0-9]+([-.]{1}[a-zA-Z0-9]+)*\.[a-zA-Z]{2,}$/;return!!t.match(r)}function o(t){if(!(typeof t!="string"||t.length===0))return!(t.length>1&&R(t))}function g(t,r="cert"){let i;switch(r){case"csr":i=/^-----BEGIN CERTIFICATE REQUEST-----\n[\s\S]+?\n-----END CERTIFICATE REQUEST-----$/;break;case"key":i=/^-----BEGIN RSA PRIVATE KEY-----\n[\s\S]+?\n-----END RSA PRIVATE KEY-----$/;break;case"cert":default:i=/^-----BEGIN CERTIFICATE-----\n[\s\S]+?\n-----END CERTIFICATE-----$/;break}return i.test(t)}function a(t,r=null){if(!(typeof t!="string"||t.length===0))return!(t.length>1&&g(t,r))}var p=[{id:"cert_domain",content:null,type:"cert",title:"Domain certificate",name:"domain",placeholder:`-----BEGIN CERTIFICATE-----
Enter domain certificate
-----END CERTIFICATE-----`,format:"crt",required:!0},{id:"cert_inter",content:null,type:"cert",title:"Intermediate CA certificate",name:"intermediate",placeholder:`-----BEGIN CERTIFICATE-----
Enter intermediate CA certificate
-----END CERTIFICATE-----`,format:"crt",required:!1},{id:"cert_root",content:null,type:"cert",title:"Root CA certificate",name:"root",placeholder:`-----BEGIN CERTIFICATE-----
Enter root CA certificate
-----END CERTIFICATE-----`,format:"crt",required:!0},{id:"private_key",content:null,type:"key",title:"Private key",name:"private",placeholder:`-----BEGIN RSA PRIVATE KEY-----
Enter private key
-----END RSA PRIVATE KEY-----`,format:"key",required:!0},{id:"csr_code",content:null,type:"csr",title:"Certificate signing request",name:"request",placeholder:`-----BEGIN CERTIFICATE REQUEST-----
Enter certificate signing request
-----END CERTIFICATE REQUEST-----`,format:"csr",required:!1}];const y=C("global",()=>{const t=u(""),r=u(p),i=u(l.language||A);function c(e){i.value=e,l.changeLanguage(e)}l.on("languageChanged",e=>{i.value=e});const E=T(()=>o(t.value));function s(e,n){return a(e,n)}function f(e){return r.value.find(n=>n.id===e)}function d(){return r.value.every(e=>e.required?e.content!==null&&e.content.trim()!=="":!0)}function I(){return o(t.value)||t.value.trim()===""?!1:r.value.every(e=>e.required?e.content&&e.content.trim()!==""&&!a(e.content,e.type):e.content&&e.content.trim()!==""?!a(e.content,e.type):!0)}function m(){const e=r.value.filter(n=>!!(n.required&&(!n.content||n.content.trim()==="")||n.content&&n.content.trim()!==""&&a(n.content,n.type))).map(n=>n.title);return(o(t.value)||t.value.trim()==="")&&e.unshift("Domain name"),e}return{domainName:t,currentLanguage:i,setLanguage:c,checkAriaInvalidDomainName:E,checkAriaInvalidCertContent:s,certs:r,getCertById:f,areRequiredCertsFilled:d,areCertsValid:I,getInvalidCerts:m}});export{y as u};
