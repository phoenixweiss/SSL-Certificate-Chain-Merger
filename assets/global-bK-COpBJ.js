import{l as d,r as l,e as I}from"./index-B7EEMUtV.js";function C(e){const r=/^[a-zA-Z0-9]+([-.]{1}[a-zA-Z0-9]+)*\.[a-zA-Z]{2,}$/;return!!e.match(r)}function u(e){if(!(typeof e!="string"||e.length===0))return!(e.length>1&&C(e))}function m(e,r="cert"){let i;switch(r){case"csr":i=/^-----BEGIN CERTIFICATE REQUEST-----\n[\s\S]+?\n-----END CERTIFICATE REQUEST-----$/;break;case"key":i=/^-----BEGIN RSA PRIVATE KEY-----\n[\s\S]+?\n-----END RSA PRIVATE KEY-----$/;break;case"cert":default:i=/^-----BEGIN CERTIFICATE-----\n[\s\S]+?\n-----END CERTIFICATE-----$/;break}return i.test(e)}function a(e,r=null){if(!(typeof e!="string"||e.length===0))return!(e.length>1&&m(e,r))}var T=[{id:"cert_domain",content:null,type:"cert",title:"Domain certificate",name:"domain",placeholder:`-----BEGIN CERTIFICATE-----
Enter domain certificate
-----END CERTIFICATE-----`,format:"crt",required:!0},{id:"cert_inter",content:null,type:"cert",title:"Intermediate CA certificate",name:"intermediate",placeholder:`-----BEGIN CERTIFICATE-----
Enter intermediate CA certificate
-----END CERTIFICATE-----`,format:"crt",required:!1},{id:"cert_root",content:null,type:"cert",title:"Root CA certificate",name:"root",placeholder:`-----BEGIN CERTIFICATE-----
Enter root CA certificate
-----END CERTIFICATE-----`,format:"crt",required:!0},{id:"private_key",content:null,type:"key",title:"Private key",name:"private",placeholder:`-----BEGIN RSA PRIVATE KEY-----
Enter private key
-----END RSA PRIVATE KEY-----`,format:"key",required:!0},{id:"csr_code",content:null,type:"csr",title:"Certificate signing request",name:"request",placeholder:`-----BEGIN CERTIFICATE REQUEST-----
Enter certificate signing request
-----END CERTIFICATE REQUEST-----`,format:"csr",required:!1}];const R=d("global",()=>{const e=l(""),r=l(T),i=I(()=>u(e.value));function o(t,n){return a(t,n)}function c(t){return r.value.find(n=>n.id===t)}function E(){return r.value.every(t=>t.required?t.content!==null&&t.content.trim()!=="":!0)}function f(){return u(e.value)||e.value.trim()===""?!1:r.value.every(t=>t.required?t.content&&t.content.trim()!==""&&!a(t.content,t.type):t.content&&t.content.trim()!==""?!a(t.content,t.type):!0)}function s(){const t=r.value.filter(n=>!!(n.required&&(!n.content||n.content.trim()==="")||n.content&&n.content.trim()!==""&&a(n.content,n.type))).map(n=>n.title);return(u(e.value)||e.value.trim()==="")&&t.unshift("Domain name"),t}return{domainName:e,checkAriaInvalidDomainName:i,checkAriaInvalidCertContent:o,certs:r,getCertById:c,areRequiredCertsFilled:E,areCertsValid:f,getInvalidCerts:s}});export{R as u};
